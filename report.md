# –û—Ç—á—ë—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ "–ü–õ–ö"

- [–û—Ç—á—ë—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ "–ü–õ–ö"](#–æ—Ç—á—ë—Ç-–æ-–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏-–∑–∞–¥–∞—á–∏-–ø–ª–∫)
  - [–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏](#–ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞-–∑–∞–¥–∞—á–∏)
  - [–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –≤–≤–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è](#–∏–∑–≤–µ—Å—Ç–Ω—ã–µ-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è-–∏-–≤–≤–æ–¥–Ω—ã–µ-—É—Å–ª–æ–≤–∏—è)
    - [–¶–µ–ª–∏ –∏ –ü—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–¶–ü–ë)](#—Ü–µ–ª–∏-–∏-–ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏-—Ü–ø–±)
  - [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã)
    - [–î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö (DFD)](#–¥–∏–∞–≥—Ä–∞–º–º–∞-–ø–æ—Ç–æ–∫–æ–≤-–¥–∞–Ω–Ω—ã—Ö-dfd)
    - [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
    - [–û–ø–µ—Ä–∞—Ü–∏–∏](#–æ–ø–µ—Ä–∞—Ü–∏–∏)
    - [–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã —Ä–µ—à–µ–Ω–∏—è](#–∞–ª–≥–æ—Ä–∏—Ç–º-—Ä–∞–±–æ—Ç—ã-—Ä–µ—à–µ–Ω–∏—è)
    - [–û–ø–∏—Å–∞–Ω–∏–µ –°—Ü–µ–Ω–∞—Ä–∏–µ–≤ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π), –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö –¶–ë –Ω–∞—Ä—É—à–∞—é—Ç—Å—è](#–æ–ø–∏—Å–∞–Ω–∏–µ-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è-–æ–ø–µ—Ä–∞—Ü–∏–π-–ø—Ä–∏-–∫–æ—Ç–æ—Ä—ã—Ö-—Ü–±-–Ω–∞—Ä—É—à–∞—é—Ç—Å—è)
    - [–ü–æ–ª–∏—Ç–∏–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#–ø–æ–ª–∏—Ç–∏–∫–∞-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
    - [–ü–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#–ø–æ–ª–∏—Ç–∏–∫–∏-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
  - [–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Ç–µ—Å—Ç–æ–≤](#–∑–∞–ø—É—Å–∫-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è-–∏-—Ç–µ—Å—Ç–æ–≤)
    - [–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#–∑–∞–ø—É—Å–∫-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
    - [–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤](#–∑–∞–ø—É—Å–∫-—Ç–µ—Å—Ç–æ–≤)

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏
–ü–õ–ö –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º (–ê–°–£ –¢–ü) —Å –∫–æ–Ω–µ—á–Ω—ã–º
–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º.

–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤—ã–ø–æ–ª–Ω—è–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Ö–Ω. –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º –ø–æ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–π
–ø—Ä–æ–≥—Ä–∞–º–º–µ, –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–π –∏–Ω–∂–µ–Ω–µ—Ä–æ–º-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º.

–ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (–ü–ü) —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ü–û. –î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è
–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –≥–∏–±–∫–æ—Å—Ç–∏ –Ω–∞–ª–∞–¥–∫–∏ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
–ü–ü –º–æ–∂–µ—Ç —Å–≤–æ–±–æ–¥–Ω–æ –º–µ–Ω—è—Ç—å—Å—è –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º
–ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ü–û.

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –≤–≤–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è



### –¶–µ–ª–∏ –∏ –ü—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–¶–ü–ë)
**–¶–µ–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
1. –ê–°–£ –¢–ü –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
2. –ü–õ–ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –∞—É—Ç–µ–Ω—Ç–∏—á–Ω–æ–µ –ü–ü
3. –ö–æ–Ω–µ—á–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
4. –¢–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –∫ –ª–∏—Ü–µ–Ω–∑–∏–∏ –ü–õ–ö
5. –°–∏—Å—Ç–µ–º–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –¥–æ—Å—Ç–∞–≤–∫—É —Å–∏–≥–Ω–∞–ª–æ–≤ –∑–∞ –∫–æ–Ω–µ—á–Ω–æ–µ –≤—Ä–µ–º—è


**–ü—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- –§–∏–∑–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ –ø–µ—Ä–∏–º–µ—Ç—Ä–∞ –æ–±–µ—Å–ø–µ—á–µ–Ω–∞
- –ü–µ—Ä—Å–æ–Ω–∞–ª –¢–≠–¶ –±–ª–∞–≥–æ–Ω–∞–¥–µ–∂–µ–Ω
- –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–Ω–æ
- –£—Ä–æ–≤–µ–Ω—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ - –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–π
- –û–ø–µ—Ä–∞—Ç–æ—Ä –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ —É–¥–∞–ª—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø


## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö (DFD)
![–î–∏–∞–≥—Ä–∞–º–º–∞_–ø–æ—Ç–æ–∫–æ–≤_–¥–∞–Ω–Ω—ã—Ö](docs/images/dfd.png)

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–î–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**
| –ù–∞–∑–≤–∞–Ω–∏–µ             | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                  | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------------------|---------------------------------------------|-|
| **IAM**              | –ú–æ–¥—É–ª—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏       | |
| **License server**   | –°–µ—Ä–≤–µ—Ä –ª–∏—Ü–µ–Ω–∑–∏–π                             | |
| **Cutoff**           | –ú–æ–¥—É–ª—å –∞–≤–∞—Ä–∏–π–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è                | |
| **PLC Control**      | –ú–æ–¥—É–ª—å –ü–õ–ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π | |
| **PLC digital**      | –í—Ö–æ–¥–Ω–æ–π –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –º–æ–¥—É–ª—å –ü–õ–ö               | |
| **PLC Updater**      | –°–µ—Ä–≤–∏—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ü–ü –ü–õ–ö                    | |
| **SCADA out**        | –ú–æ–¥—É–ª—å –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ SCADA              | |
| **Security Monitor** | –ú–æ–Ω–∏—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏                        | |

**–ù–µ–¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**
| –ù–∞–∑–≤–∞–Ω–∏–µ           | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                            | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------------------|---------------------------------------|-|
| **SCADA in**       | –ú–æ–¥—É–ª—å –≤–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ SCADA         | |
| **PLC analog**     | –í—Ö–æ–¥–Ω–æ–π –∞–Ω–∞–ª–æ–≥–æ–≤—ã–π –º–æ–¥—É–ª—å –ü–õ–ö         | |
| **Keygen**         | –ú–æ–¥—É–ª—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫—Ä–∏–ø—Ç–æ–∫–ª—é—á–µ–π –¥–ª—è IAM | |
| **Update manager** | –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π                | |
| **Downloader**     | –ó–∞–≥—Ä—É–∑—á–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π                  | |
| **Storage**        | –•—Ä–∞–Ω–∏–ª–∏—â–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ü–ü –ü–õ–ö           | |

**–û–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**
| –ù–∞–∑–≤–∞–Ω–∏–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------------|----------------------------------------|-|
| **File server** | –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π                 | |
| **Temperature** | –ê–Ω–∞–ª–æ–≥–æ–≤—ã–π –¥–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã          | |
| **Power**       | –ê–Ω–∞–ª–æ–≥–æ–≤—ã–π –∏–∑–º–µ—Ä–∏—Ç–µ–ª—å –º–æ—â–Ω–æ—Å—Ç–∏ —Ç—É—Ä–±–∏–Ω—ã | |
| **Speed**       | –î–∞—Ç—á–∏–∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—Ä–∞—â–µ–Ω–∏—è               | |

### –û–ø–µ—Ä–∞—Ü–∏–∏
| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ           | –ò—Å—Ç–æ—á–Ω–∏–∫             | –ö–∞–Ω–∞–ª | –û–ø–µ—Ä–∞—Ü–∏—è                  | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|----------------------|----------------------|:-----:|---------------------------|---|
| **Cutoff**           | **IAM**              | MB    | `hard_stop`               | üü¢ |
| **Cutoff**           | **PLC control**      | MB    | `hard_stop`               | üü¢ |
| **Downloader**       | **Update manager**   | MB    | `request_download`        | `module_name`                   |
| **File Server**      | **Downloader**       | HTTP  | `download_update`         | GET: `filename`                 |
| **IAM**              | **SCADA in**         | MB    | `update_plc_software`     | `user`, `data`, `data.digest`   |
| **IAM**              | **SCADA in**         | MB    | `run_command`             | `user`, `data`, `data.command`  |
| **IAM**              | **SCADA in**         | MB    | `change_settings`         | `user`, `data`, `data.settings` |
| **IAM**              | **SCADA in**         | MB    | `hard_stop`               | `user`, `data`                  |
| **IAM**              | **SCADA out**        | MB    | `check_user`              | `user`, `data`                  |
| **IAM**              | **Keygen**           | MB    | `send_keys`               | |
| **Keygen**           | **IAM**              | MB    | `generate_keys`           | |
| **License Server**   | **IAM**              | MB    | `new_update_digest`       | `digest` |
| **License Server**   | **Security Monitor** | HTTP  | `check_seal`              | `digest` |
| **PLC analog**       | **Power**            | MB    | `push_power_value`        | `power` |
| **PLC analog**       | **Temperature**      | MB    | `push_temperature_value`  | `temperature` |
| **PLC control**      | **IAM**              | MB    | `change_settings`         | `settings` |
| **PLC control**      | **IAM**              | MB    | `run_command`             | `command` |
| **PLC control**      | **PLC analog**       | MB    | `push_temperature_value`  | `temperature` |
| **PLC control**      | **PLC analog**       | MB    | `push_power_value`        | `power` |
| **PLC control**      | **PLC digital**      | MB    | `push_speed_value`        | `speed` |
| **PLC digital**      | **Speed**            | MB    | `push_speed_impulse`      | üü¢ |
| **PLC Updater**      | **Storage**          | MB    | `send_software_update`    | `module_name`, `blob` |
| **PLC Updater**      | **Update manager**   | MB    | `request_software_update` | üü¢ |
| **SCADA in**         | *users*              | HTTP  | `update_plc_software`     | üü¢ |
| **SCADA in**         | *users*              | HTTP  | `run_command`             | üü¢ |
| **SCADA in**         | *users*              | HTTP  | `change_settings`         | üü¢ |
| **SCADA in**         | *users*              | HTTP  | `hard_stop`               | üü¢ |
| **SCADA out**        | **IAM**              | MB    | `authorize_user`          | `auth`, `auth.authorized` |
| **SCADA out**        | **PLC control**      | MB    | `push_speed_value`        | `speed` |
| **SCADA out**        | **Temperature**      | MB    | `push_temperature_value`  | `temperature` |
| **SCADA out**        | **Power**            | MB    | `push_power_value`        | `power` |
| **SCADA out**        | **PLC control**      | MB    | `send_alert`              | `description` |
| **SCADA out**        | *users*              | HTTP  | `subscribe`               | `user`, `data`, `address` |
| **Security Monitor** | *all*                | MB    | *all*                     | `operation` |
| **Speed**            | **PLC control**      | MB    | `change_speed`            | üü¢ |
| **Speed**            | **Cutoff**           | MB    | `shutdown`¬†               | üü¢ |
| **Storage**          | **PLC Updater**      | MB    | `get_software_update`     | üü¢ |
| **Storage**          | **Downloader**       | MB    | `save_file`               | üü¢ |
| **Update manager**   | **IAM**              | MB    | `launch_software_update`  | `module_name` |
| **Update manager**   | **Downloader**       | MB    | `report_downloaded`       | üü¢ |

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã —Ä–µ—à–µ–Ω–∏—è

### –û–ø–∏—Å–∞–Ω–∏–µ –°—Ü–µ–Ω–∞—Ä–∏–µ–≤ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π), –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö –¶–ë –Ω–∞—Ä—É—à–∞—é—Ç—Å—è

–¢–∞–±–ª–∏—Ü–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π –¶–ë, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

| –°–µ—Ä–≤–∏—Å | –¶–ë-1 | –¶–ë-2 | –¶–ë-3 | –¶–ë-4 | –¶–ë-5 | 
|------|:---:|:---:|:---:|:---:|:---:|
| **IAM** | üü¢ | üî¥ | üî¥ | üî¥ | üî¥ |
| **PLC Control** | üî¥ | üî¥ | üî¥ | üü¢ | üî¥ |
| **License server** | üü¢/üî¥ | üî¥ | üü¢/üî¥ | üî¥ | üü¢/üî¥ |
| **PLC Updater** | üü¢/üî¥ | üî¥ | üü¢/üî¥ | üü¢/üî¥ | üü¢/üî¥ |
| **Cutoff** | üü¢ | üü¢ | üî¥ | üü¢ | üî¥ |
| **PLC digital** | üî¥ | üü¢ | üü¢ | üü¢ | üü¢ |
| **SCADA out** | üî¥ | üü¢ | üü¢ | üü¢ | üü¢ |

–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

| –ù–æ–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|--|-----|
NS-1 | –í–∑–ª–æ–º –º–æ–¥—É–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
NS-2 | –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ –ª–∏—Ü–µ–Ω–∑–∏–π
NS-3 | –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –º–æ–¥—É–ª—è –ü–õ–ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π

**NS-1: –í–∑–ª–æ–º –º–æ–¥—É–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

![NS-1](docs/images/ns1.png)

**NS-2: –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ –ª–∏—Ü–µ–Ω–∑–∏–π**

![NS-2](docs/images/ns2.png)

**NS-3: –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –º–æ–¥—É–ª—è –ü–õ–ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π**

![NS-3](docs/images/ns3.png)

### –ü–æ–ª–∏—Ç–∏–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

—Å–º. [–î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö (DFD)](#–¥–∏–∞–≥—Ä–∞–º–º–∞-–ø–æ—Ç–æ–∫–æ–≤-–¥–∞–Ω–Ω—ã—Ö-dfd)

–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¶–ë-5 –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è:
| –ö–æ–º–∞–Ω–¥–∞                        | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                             | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------------------------------|----------------------------------------|-------------|
| –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è        | **Cutoff**                             | –ó–∞–ø—Ä–æ—Å –æ—Ç **IAM** –∫ **Cutoff** –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞ O(l) |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ | **PLC control**, **License Server**    | –û–ø–µ—Ä–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫ **PLC control** –∏ **License Server** –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–∞ O(l), –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ **PLC control** –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ, —á—Ç–æ —Ç–∞–∫–∂–µ –Ω–µ –æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ |

### –ü–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ 


```python {lineNo:true}
# default deny
authorized = False

policies = {
    { 'dst': 'cutoff',         'src': 'iam',            'operation': 'hard_stop'},
    { 'dst': 'cutoff',         'src': 'iam',            'operation': 'hard_stop'},
    { 'dst': 'downloader',     'src': 'update_manager', 'operation': 'request_download'},
    { 'dst': 'iam',            'src': 'scada_in',       'operation': 'update_plc_software'},
    { 'dst': 'iam',            'src': 'scada_in',       'operation': 'run_command'},
    { 'dst': 'iam',            'src': 'scada_in',       'operation': 'change_settings'},
    { 'dst': 'iam',            'src': 'scada_in',       'operation': 'hard_stop'},
    { 'dst': 'iam',            'src': 'scada_out',      'operation': 'check_user'},
    { 'dst': 'iam',            'src': 'keygen',         'operation': 'send_keys'},
    { 'dst': 'keygen',         'src': 'iam',            'operation': 'generate_keys'},
    { 'dst': 'license_server', 'src': 'iam',            'operation': 'new_update_digest'},
    { 'dst': 'plc_analog',     'src': 'temperature',    'operation': 'push_temperature_value'},
    { 'dst': 'plc_analog',     'src': 'power',          'operation': 'push_power_value'},
    { 'dst': 'plc_control',    'src': 'iam',            'operation': 'run_command'},
    { 'dst': 'plc_control',    'src': 'iam',            'operation': 'change_settings'},
    { 'dst': 'plc_control',    'src': 'plc_digital',    'operation': 'push_speed_value'},
    { 'dst': 'plc_control',    'src': 'plc_analog',     'operation': 'push_temperature_value'},
    { 'dst': 'plc_control',    'src': 'plc_analog',     'operation': 'push_power_value'},
    { 'dst': 'plc_digital',    'src': 'speed',          'operation': 'push_speed_impulse'},
    { 'dst': 'plc_updater',    'src': 'storage',        'operation': 'send_software_update'},
    { 'dst': 'plc_updater',    'src': 'update_manager', 'operation': 'request_software_update'},
    { 'dst': 'scada_out',      'src': 'iam',            'operation': 'authorize_user'},
    { 'dst': 'scada_out',      'src': 'plc_control',    'operation': 'push_speed_value'},
    { 'dst': 'scada_out',      'src': 'plc_control',    'operation': 'send_alert'},
    { 'dst': 'scada_out',      'src': 'temperature',    'operation': 'push_temperature_value'},
    { 'dst': 'scada_out',      'src': 'power',          'operation': 'push_power_value'},
    { 'dst': 'speed',          'src': 'plc_control',    'operation': 'change_speed'},
    { 'dst': 'speed',          'src': 'cutoff',         'operation': 'change_speed'},
    { 'dst': 'storage',        'src': 'plc_updater',    'operation': 'get_software_update'},
    { 'dst': 'storage',        'src': 'downloader',     'operation': 'save_file'},
    { 'dst': 'update_manager', 'src': 'iam',            'operation': 'launch_software_update'},
    { 'dst': 'update_manager', 'src': 'downloader',     'operation': 'report_downloaded'}
}

if {'dst': dst, 'src': src, 'operation': operation} in policies:
    authorized = True
    if operation == "send_software_update" and check_payload_seal(details['blob']) is False:
        authorized = False

return authorized
```

## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Ç–µ—Å—Ç–æ–≤

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ó–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–∞: –æ—Ç–∫—Ä—ã—Ç—å –æ–∫–Ω–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –≤ Visual Studio code, –≤ –ø–∞–ø–∫–µ —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å 

**make run**
–∏–ª–∏ **docker-compose up -d --build**

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

_–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –≤ —Ö–æ–¥–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Ä–∞–±–æ—á–µ–≥–æ –º–µ—Å—Ç–∞ –≤—Å–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã._

**make test**

